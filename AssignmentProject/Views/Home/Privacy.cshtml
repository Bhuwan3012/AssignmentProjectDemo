<!DOCTYPE html>
<html lang="en" ng-app="taskApp">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task Management Application</title>

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="/task.js"></script>
</head>

<body ng-controller="taskController">

    <div class="container">
        <h2>Task Management Application</h2>

        <div class="row">
            <div class="col">
                <label>Task Title</label>
                <input type="text" ng-model="task.taskTitle" placeholder="Enter Task Title">
            </div>

            <div class="col">
                <label>Task Due Date</label>
                <input type="date" ng-model="task.taskDueDate">
            </div>

            <div class="col">
                <label>Task Status</label>
                <select ng-model="task.taskStatus">
                    <option value="">-- Select Status --</option>
                    <option value="Pending">Pending</option>
                    <option value="In Progress">In Progress</option>
                    <option value="Completed">Completed</option>
                </select>
            </div>
        </div>

        <div class="row">
            <div class="col">
                <label>Task Description</label>
                <textarea ng-model="task.taskDescription" placeholder="Enter Description"></textarea>
            </div>

            <div class="col">
                <label>Task Remarks</label>
                <textarea ng-model="task.taskRemarks" placeholder="Enter Remarks"></textarea>
            </div>
        </div>


        <div class="row">
            <div class="col">
                <label>Created By Name</label>
                <input type="text" ng-model="task.createdByName" readonly>
            </div>

            <div class="col">
                <label>Created By ID</label>
                <input type="text" ng-model="task.createdById" readonly>
            </div>
        </div>

   
        <div class="row" ng-show="isEdit">
            <div class="col">
                <label>Updated By Name</label>
                <input type="text" ng-model="task.lastUpdatedByName" readonly>
            </div>

            <div class="col">
                <label>Updated By ID</label>
                <input type="text" ng-model="task.lastUpdatedById" readonly>
            </div>
        </div>

        <br>

        <button class="btn-add" ng-click="createTask()" ng-show="!isEdit">Add Task</button>
        <button class="btn-add" ng-click="updateTask()" ng-show="isEdit">Update Task</button>
        <button class="btn-clear" ng-click="clearForm()">Clear</button>

        <div style="margin-top:15px;">
            <label>Search Task</label>
            <input type="text" ng-model="searchText" ng-change="searchTask()" placeholder="Search by title/status/createdby">
        </div>

     
        <table border="1" width="100%" style="margin-top:15px;">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Due Date</th>
                    <th>Status</th>
                    <th>Remarks</th>
                    <th>Created On</th>
                    <th>Updated On</th>
                    <th>Created By</th>
                    <th>Created Id</th>
                    <th>Updated By</th>
                    <th>Action</th>
                </tr>
            </thead>

            <tbody>
                <tr ng-repeat="t in tasks">
                    <td>{{t.taskId}}</td>
                    <td>{{t.taskTitle}}</td>
                    <td>{{t.taskDescription}}</td>
                    <td>{{t.taskDueDate | date:'yyyy-MM-dd'}}</td>
                    <td>{{t.taskStatus}}</td>
                    <td>{{t.taskRemarks}}</td>
                    <td>{{t.createdOn | date:'yyyy-MM-dd HH:mm:ss'}}</td>

                    <td>
                        <span ng-if="t.lastUpdatedOn">
                            {{t.lastUpdatedOn | date:'yyyy-MM-dd HH:mm:ss'}}
                        </span>
                        <span ng-if="!t.lastUpdatedOn" style="color:gray;">-</span>
                    </td>

                    <td>{{t.createdByName}}</td>
                    <td>{{t.createdById}}</td>

                    <td>
                        <span ng-if="t.lastUpdatedByName">
                            {{t.lastUpdatedByName}} ({{t.lastUpdatedById}})
                        </span>
                        <span ng-if="!t.lastUpdatedByName" style="color:gray;">-</span>
                    </td>

                    <td>
                        <button class="btn-update" ng-click="editTask(t)">Edit</button>
                        <button class="btn-delete" ng-click="deleteTask(t.taskId, t.createdById)">Delete</button>
                    </td>
                </tr>

                <tr ng-if="tasks.length==0">
                    <td colspan="12" style="text-align:center;color:gray;font-weight:bold;">
                        No Task Found
                    </td>
                </tr>
            </tbody>
        </table>

    </div>

    <div style="text-align:right; margin-bottom:15px;">
        <button class="btn-logout" ng-click="logout()">Logout</button>
    </div>

</body>
</html>
